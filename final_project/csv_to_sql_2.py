# This Python file uses the following encoding: utf-8
import pymysql
import csv

#create database
db = pymysql.connect(host="localhost",user="root",passwd="computers")
cur = db.cursor()
sql = 'DROP DATABASE IF EXISTS dicegame'
cur.execute(sql)
sql = 'CREATE DATABASE IF NOT EXISTS dicegame'
cur.execute(sql)
db.commit()
print "Database 'dicegame' created"

#create table
dbname="dicegame"
host="localhost"
user="root"
passwd="computers"
db=pymysql.connect(db=dbname, host=host, user=user,passwd=passwd, charset='utf8')

cur = db.cursor()

drop_table = '''DROP TABLE IF EXISTS dicegame;'''
create_table = '''
CREATE TABLE IF NOT EXISTS dicegame(
  V1 VARCHAR(20)
, V2 VARCHAR(50)
, V3 VARCHAR(20)
, V4 VARCHAR(21)
, V5 VARCHAR(12)
, V6 VARCHAR(20)
, V7 VARCHAR(6)
, V8 VARCHAR(50)
, V9 VARCHAR(50)
, V10 VARCHAR(8)
, SC0_0 VARCHAR(9)
, SC0_1 VARCHAR(17)
, SC0_2 VARCHAR(20)
, SC1_0 VARCHAR(14)
, SC1_1 VARCHAR(22)
, SC1_2 VARCHAR(25)
, 2_EMPTY VARCHAR(5)
, cond VARCHAR(20)
, Q325_1 VARCHAR(172)
, Q325_1_TEXT VARCHAR(177)
, Q325_2 VARCHAR(143)
, Q325_2_TEXT VARCHAR(148)
, Q2 VARCHAR(108)
, Q4 VARCHAR(102)
, Q207_1 VARCHAR(113)
, Q314 VARCHAR(49)
, Q316 VARCHAR(43)
, Q318 VARCHAR(50)
, Q319_1 VARCHAR(40)
, Q320 VARCHAR(39)
, Q321 VARCHAR(40)
, Q322 VARCHAR(40)
, Q323 VARCHAR(40)
, Q324_1 VARCHAR(40)
, Q325 VARCHAR(40)
, LS11 VARCHAR(54)
, LS12 VARCHAR(44)
, LS13 VARCHAR(51)
, LS14 VARCHAR(40)
, LS15 VARCHAR(39)
, LS16 VARCHAR(40)
, LS17 VARCHAR(40)
, LS18 VARCHAR(40)
, LS19 VARCHAR(40)
, LS20 VARCHAR(40)
, LS21 VARCHAR(52)
, LS22 VARCHAR(43)
, LS23 VARCHAR(50)
, LS24 VARCHAR(40)
, LS25 VARCHAR(39)
, LS26 VARCHAR(40)
, LS27 VARCHAR(40)
, LS28 VARCHAR(40)
, LS29 VARCHAR(40)
, LS30 VARCHAR(40)
, LS31 VARCHAR(52)
, LS32 VARCHAR(44)
, LS33 VARCHAR(51)
, LS34 VARCHAR(40)
, LS35 VARCHAR(39)
, LS36 VARCHAR(40)
, LS37 VARCHAR(40)
, LS38 VARCHAR(40)
, LS39 VARCHAR(40)
, LS40 VARCHAR(40)
, LS41 VARCHAR(52)
, LS42 VARCHAR(43)
, LS43 VARCHAR(50)
, LS44 VARCHAR(40)
, LS45 VARCHAR(39)
, LS46 VARCHAR(40)
, LS47 VARCHAR(40)
, LS48 VARCHAR(40)
, LS49 VARCHAR(40)
, LS50 VARCHAR(40)
, LS51 VARCHAR(52)
, LS52 VARCHAR(43)
, LS53 VARCHAR(50)
, LS54 VARCHAR(40)
, LS55 VARCHAR(39)
, LS56 VARCHAR(40)
, LS57 VARCHAR(40)
, LS58 VARCHAR(40)
, LS59 VARCHAR(40)
, LS60 VARCHAR(40)
, LS61 VARCHAR(52)
, LS62 VARCHAR(45)
, LS63 VARCHAR(52)
, LS64 VARCHAR(40)
, Ls65 VARCHAR(39)
, LS66 VARCHAR(40)
, LS67 VARCHAR(40)
, LS68 VARCHAR(40)
, LS69 VARCHAR(40)
, LS70 VARCHAR(39)
, LS71 VARCHAR(52)
, LS72 VARCHAR(44)
, LS73 VARCHAR(51)
, LS74 VARCHAR(40)
, LS75 VARCHAR(39)
, LS76 VARCHAR(40)
, LS77 VARCHAR(40)
, LS78 VARCHAR(40)
, LS79 VARCHAR(40)
, LS80 VARCHAR(40)
, LS81 VARCHAR(52)
, LS82 VARCHAR(44)
, LS83 VARCHAR(51)
, LS84 VARCHAR(40)
, LS85 VARCHAR(39)
, LS86 VARCHAR(40)
, LS87 VARCHAR(40)
, LS88 VARCHAR(39)
, LS89 VARCHAR(40)
, LS90 VARCHAR(39)
, LS91 VARCHAR(52)
, LS92 VARCHAR(43)
, LS93 VARCHAR(50)
, LS94 VARCHAR(40)
, LS95 VARCHAR(39)
, LS96 VARCHAR(40)
, LS97_1 VARCHAR(40)
, LS97 VARCHAR(40)
, LS98 VARCHAR(40)
, LS99 VARCHAR(40)
, Q319 VARCHAR(102)
, LC1 VARCHAR(114)
, LC2 VARCHAR(48)
, LC3_1 VARCHAR(43)
, LC4_1 VARCHAR(50)
, Q197 VARCHAR(40)
, LC3 VARCHAR(39)
, LC4 VARCHAR(39)
, LC5 VARCHAR(40)
, LC6 VARCHAR(40)
, LC7 VARCHAR(40)
, LC8 VARCHAR(40)
, LC9 VARCHAR(52)
, LC10 VARCHAR(44)
, LC11 VARCHAR(51)
, Q198 VARCHAR(40)
, LC12 VARCHAR(39)
, LC13 VARCHAR(40)
, LC14 VARCHAR(40)
, LC15 VARCHAR(40)
, LC16 VARCHAR(40)
, LC17 VARCHAR(40)
, LC18 VARCHAR(52)
, LC19 VARCHAR(43)
, LC20 VARCHAR(50)
, Q200 VARCHAR(40)
, LC21 VARCHAR(39)
, LC22 VARCHAR(40)
, LC23 VARCHAR(40)
, LC24 VARCHAR(40)
, LC25 VARCHAR(40)
, LC26 VARCHAR(40)
, LC27 VARCHAR(52)
, LC28 VARCHAR(44)
, LC29 VARCHAR(51)
, Q201 VARCHAR(40)
, LC30 VARCHAR(39)
, LC31 VARCHAR(40)
, LC32 VARCHAR(40)
, LC33 VARCHAR(40)
, LC34 VARCHAR(40)
, LC35 VARCHAR(40)
, LC36 VARCHAR(53)
, LC37 VARCHAR(43)
, LC38 VARCHAR(50)
, Q202 VARCHAR(40)
, LC39 VARCHAR(39)
, LC40 VARCHAR(40)
, LC41 VARCHAR(40)
, LC42 VARCHAR(39)
, LC43 VARCHAR(40)
, LC44_1 VARCHAR(40)
, LC44 VARCHAR(52)
, LC45 VARCHAR(43)
, LC46 VARCHAR(50)
, Q203 VARCHAR(40)
, LC47 VARCHAR(39)
, LC48 VARCHAR(40)
, LC49 VARCHAR(40)
, LC50 VARCHAR(40)
, LC51 VARCHAR(40)
, LC52 VARCHAR(40)
, LC53 VARCHAR(54)
, LC54 VARCHAR(45)
, LC55 VARCHAR(52)
, Q204 VARCHAR(40)
, LC56 VARCHAR(39)
, LC57 VARCHAR(40)
, LC58 VARCHAR(40)
, LC59 VARCHAR(40)
, LC60 VARCHAR(40)
, LC61 VARCHAR(40)
, LC62 VARCHAR(52)
, LC63 VARCHAR(44)
, LC64 VARCHAR(51)
, Q205 VARCHAR(40)
, LC65 VARCHAR(39)
, LC66 VARCHAR(40)
, LC67 VARCHAR(40)
, LC68 VARCHAR(40)
, LC69 VARCHAR(40)
, LC70 VARCHAR(40)
, LC71 VARCHAR(52)
, LC72 VARCHAR(44)
, LC73 VARCHAR(51)
, Q206 VARCHAR(26)
, LC74 VARCHAR(38)
, LC75 VARCHAR(40)
, LC76 VARCHAR(40)
, LC77 VARCHAR(40)
, LC78 VARCHAR(40)
, LC79 VARCHAR(40)
, LC80 VARCHAR(49)
, LC81 VARCHAR(43)
, LC82 VARCHAR(50)
, Q207_2 VARCHAR(40)
, LC83 VARCHAR(38)
, LC84 VARCHAR(40)
, LC85 VARCHAR(39)
, LC86 VARCHAR(40)
, LC87 VARCHAR(40)
, LC88 VARCHAR(40)
, Q207 VARCHAR(102)
, GCD VARCHAR(110)
, GC1 VARCHAR(43)
, GC2 VARCHAR(50)
, GC3 VARCHAR(82)
, GC4 VARCHAR(38)
, Q93 VARCHAR(44)
, Q95 VARCHAR(51)
, Q98 VARCHAR(80)
, Q97 VARCHAR(38)
, Q101 VARCHAR(43)
, Q103 VARCHAR(50)
, GC5 VARCHAR(80)
, GC6 VARCHAR(38)
, GC7 VARCHAR(44)
, GC8 VARCHAR(51)
, GC9 VARCHAR(82)
, GC10 VARCHAR(38)
, GC11 VARCHAR(43)
, GC12 VARCHAR(50)
, GC13 VARCHAR(81)
, GC14 VARCHAR(38)
, GC15 VARCHAR(43)
, GC16 VARCHAR(50)
, GC17 VARCHAR(81)
, GC18 VARCHAR(38)
, GC19 VARCHAR(45)
, GC20 VARCHAR(52)
, GC21 VARCHAR(81)
, GC22 VARCHAR(38)
, GC23 VARCHAR(44)
, GC24 VARCHAR(51)
, GC25 VARCHAR(81)
, GC26 VARCHAR(38)
, GC27 VARCHAR(44)
, GC28 VARCHAR(51)
, GC29 VARCHAR(80)
, GC30 VARCHAR(38)
, GC31 VARCHAR(43)
, GC32 VARCHAR(50)
, GC33 VARCHAR(81)
, CG34 VARCHAR(38)
, Q127 VARCHAR(102)
, GSD VARCHAR(114)
, GS1 VARCHAR(43)
, GS2 VARCHAR(42)
, GS3 VARCHAR(81)
, GS4 VARCHAR(38)
, GS5 VARCHAR(44)
, GS6_1 VARCHAR(43)
, GS6 VARCHAR(80)
, GS7 VARCHAR(38)
, GS8_1 VARCHAR(43)
, GS8 VARCHAR(42)
, GS9_1 VARCHAR(80)
, GS9 VARCHAR(38)
, GS10 VARCHAR(44)
, GS11 VARCHAR(43)
, GS12 VARCHAR(81)
, GS13 VARCHAR(38)
, GS14 VARCHAR(43)
, GS15 VARCHAR(42)
, GS16 VARCHAR(81)
, GS17 VARCHAR(38)
, GS18 VARCHAR(43)
, GS19 VARCHAR(43)
, GS20 VARCHAR(79)
, GS21 VARCHAR(38)
, GS22 VARCHAR(45)
, GS23 VARCHAR(45)
, GS24 VARCHAR(79)
, GS25 VARCHAR(38)
, GS26 VARCHAR(44)
, GS27 VARCHAR(43)
, GS28 VARCHAR(79)
, GS29 VARCHAR(38)
, GS30 VARCHAR(44)
, GS31 VARCHAR(42)
, GS32 VARCHAR(81)
, GS33 VARCHAR(38)
, GS34 VARCHAR(43)
, GS35 VARCHAR(42)
, GS36 VARCHAR(79)
, GS37 VARCHAR(38)
, Q128 VARCHAR(102)
, Q114 VARCHAR(103)
, Q114_TEXT TEXT
, Q118 TEXT
, Q120 VARCHAR(102)
, Q124_1 VARCHAR(106)
, Q124_2 VARCHAR(106)
, Q124_3 VARCHAR(106)
, Q124_4 VARCHAR(106)
, Q124_5 VARCHAR(106)
, Q124_6 VARCHAR(106)
, Q134_1 VARCHAR(162)
, Q134_2 VARCHAR(142)
, Q134_3 VARCHAR(140)
, Q134_4 VARCHAR(176)
, Q134_5 VARCHAR(145)
, Q134_6 VARCHAR(133)
, Q138_1_TEXT VARCHAR(125)
, Q138_2_TEXT VARCHAR(112)
, Q138_3_TEXT VARCHAR(113)
, Q138_4_TEXT VARCHAR(117)
, Q140 VARCHAR(37)
, Q144 VARCHAR(32)
, Q146 VARCHAR(102)
, Q324 VARCHAR(92)
, LocationLatitude VARCHAR(16)
, LocationLongitude VARCHAR(17)
, LocationAccuracy VARCHAR(16)
)ENGINE=MyISAM DEFAULT CHARSET=utf8;
'''
#try:
#	cur.execute(create_table)
#except TypeError:
#	print "Encountered TypeError while creating table. Doublecheck table status in MYSQL."
#	pass
cur.execute(drop_table)
cur.execute(create_table)

sql = '''desc dicegame;'''
cur.execute(sql)


db.commit()
print "Table 'dicegame' created."


csv_data = csv.reader(file('Dice_Game_GainLoss__CompSalient_noduplicates.csv'))
next(csv_data, None) #skip varnames
next(csv_data, None) #skip varlabels
for row in csv_data:
    cur.execute('INSERT INTO dicegame(V1, V2, V3, V4, V5, V6, V7, V8, V9, V10, SC0_0, SC0_1, SC0_2, SC1_0, SC1_1, SC1_2, 2_EMPTY, cond, Q325_1, Q325_1_TEXT, Q325_2, Q325_2_TEXT, Q2, Q4, Q207_1, Q314, Q316, Q318, Q319_1, Q320, Q321, Q322, Q323, Q324_1, Q325, LS11, LS12, LS13, LS14, LS15, LS16, LS17, LS18, LS19, LS20, LS21, LS22, LS23, LS24, LS25, LS26, LS27, LS28, LS29, LS30, LS31, LS32, LS33, LS34, LS35, LS36, LS37, LS38, LS39, LS40, LS41, LS42, LS43, LS44, LS45, LS46, LS47, LS48, LS49, LS50, LS51, LS52, LS53, LS54, LS55, LS56, LS57, LS58, LS59, LS60, LS61, LS62, LS63, LS64, Ls65, LS66, LS67, LS68, LS69, LS70, LS71, LS72, LS73, LS74, LS75, LS76, LS77, LS78, LS79, LS80, LS81, LS82, LS83, LS84, LS85, LS86, LS87, LS88, LS89, LS90, LS91, LS92, LS93, LS94, LS95, LS96, LS97_1, LS97, LS98, LS99, Q319, LC1, LC2, LC3_1, LC4_1, Q197, LC3, LC4, LC5, LC6, LC7, LC8, LC9, LC10, LC11, Q198, LC12, LC13, LC14, LC15, LC16, LC17, LC18, LC19, LC20, Q200, LC21, LC22, LC23, LC24, LC25, LC26, LC27, LC28, LC29, Q201, LC30, LC31, LC32, LC33, LC34, LC35, LC36, LC37, LC38, Q202, LC39, LC40, LC41, LC42, LC43, LC44_1, LC44, LC45, LC46, Q203, LC47, LC48, LC49, LC50, LC51, LC52, LC53, LC54, LC55, Q204, LC56, LC57, LC58, LC59, LC60, LC61, LC62, LC63, LC64, Q205, LC65, LC66, LC67, LC68, LC69, LC70, LC71, LC72, LC73, Q206, LC74, LC75, LC76, LC77, LC78, LC79, LC80, LC81, LC82, Q207_2, LC83, LC84, LC85, LC86, LC87, LC88, Q207, GCD, GC1, GC2, GC3, GC4, Q93, Q95, Q98, Q97, Q101, Q103, GC5, GC6, GC7, GC8, GC9, GC10, GC11, GC12, GC13, GC14, GC15, GC16, GC17, GC18, GC19, GC20, GC21, GC22, GC23, GC24, GC25, GC26, GC27, GC28, GC29, GC30, GC31, GC32, GC33, CG34, Q127, GSD, GS1, GS2, GS3, GS4, GS5, GS6_1, GS6, GS7, GS8_1, GS8, GS9_1, GS9, GS10, GS11, GS12, GS13, GS14, GS15, GS16, GS17, GS18, GS19, GS20, GS21, GS22, GS23, GS24, GS25, GS26, GS27, GS28, GS29, GS30, GS31, GS32, GS33, GS34, GS35, GS36, GS37, Q128, Q114, Q114_TEXT, Q118, Q120, Q124_1, Q124_2, Q124_3, Q124_4, Q124_5, Q124_6, Q134_1, Q134_2, Q134_3, Q134_4, Q134_5, Q134_6, Q138_1_TEXT, Q138_2_TEXT, Q138_3_TEXT, Q138_4_TEXT, Q140, Q144, Q146, Q324, LocationLatitude, LocationLongitude, LocationAccuracy)' \
          'VALUES("%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s", "%s")', row)

#close the connection to the database.
db.commit()
cur.close()
print "Table 'dicegame' successfully populated."